{"version":3,"sources":["Chat.js","App.js","index.js"],"names":["myId","myUuid","uuid","socket","io","Chat","React","useState","message","setMessage","messages","setMessages","inputRef","useRef","messagesBox","useEffect","window","localStorage","getItem","setItem","messagesStorage","JSON","parse","setTimeout","current","scrollTo","scrollHeight","focus","on","newMessage","stringify","id","off","className","ref","map","index","hour","minute","key","onSubmit","event","preventDefault","trim","emit","type","placeholder","value","onChange","target","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"4MAOIA,E,kFAJEC,E,MAASC,KAGTC,EAASC,IAAG,2CA8FHC,EA3FF,WAAO,IAAD,EACaC,IAAMC,SAAS,IAD5B,mBACVC,EADU,KACDC,EADC,OAEeH,IAAMC,SAAS,IAF9B,mBAEVG,EAFU,KAEAC,EAFA,KAIXC,EAAWN,IAAMO,SACjBC,EAAcR,IAAMO,SAE1BP,IAAMS,WAAU,YACdf,EAAOgB,OAAOC,aAAaC,QAAQ,SAKjClB,EAAOgB,OAAOC,aAAaC,QAAQ,SAHnCF,OAAOC,aAAaE,QAAQ,OAAQlB,GACpCD,EAAOC,KAIR,IAEHK,IAAMS,WAAU,WACd,IAAIK,EAAkBJ,OAAOC,aAAaC,QAAQ,YAC9CE,GACFT,EAAYU,KAAKC,MAAMF,MAExB,IAEHd,IAAMS,WAAU,WACdQ,YAAW,WACTT,EAAYU,QAAQC,SAAS,EAAGX,EAAYU,QAAQE,mBAErD,IAEHpB,IAAMS,WAAU,WACdH,EAASY,QAAQG,QAEjBxB,EAAOyB,GAAG,gBAAgB,SAACpB,GACzB,IAAIqB,EAAU,sBAAOnB,GAAP,CAAiBF,IAC/BG,EAAYkB,GACZb,OAAOC,aAAaE,QAAQ,WAAYE,KAAKS,UAAUD,IAEnDrB,EAAQuB,KAAO/B,GACjBc,EAAYU,QAAQC,SAAS,EAAGX,EAAYU,QAAQE,cAEtDvB,EAAO6B,IAAI,qBAEZ,CAACtB,IAaJ,OACE,6BAASuB,UAAU,aACjB,yBAAKA,UAAU,YACb,yBAAKA,UAAU,KAAKC,IAAKpB,GACtBJ,EAASyB,KAAI,WAAgCC,GAAhC,IAAG5B,EAAH,EAAGA,QAASuB,EAAZ,EAAYA,GAAIM,EAAhB,EAAgBA,KAAMC,EAAtB,EAAsBA,OAAtB,OACZ,yBACEC,IAAKH,EACLH,UAAS,kBACPF,IAAO/B,EAAO,eAAiB,kBAGjC,2BACGQ,EACD,8BACG6B,EADH,IACUC,UAQpB,0BAAME,SAjCW,SAACC,GACpBA,EAAMC,iBACFlC,EAAQmC,SACVxC,EAAOyC,KAAK,eAAgB,CAC1Bb,GAAI/B,EACJQ,YAEFC,EAAW,OA2BT,2BACEoC,KAAK,OACLC,YAAY,sBACZC,MAAOvC,EACPwC,SAAU,gBAAGC,EAAH,EAAGA,OAAH,OAAgBxC,EAAWwC,EAAOF,QAC5Cb,IAAKtB,OCrFAsC,MAJf,WACE,OAAO,kBAAC,EAAD,OCDTC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,W","file":"static/js/main.0789ab0e.chunk.js","sourcesContent":["import React from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport uuid from \"uuid/v4\";\r\nconst myUuid = uuid();\r\n\r\n//This is my public API for test.\r\nconst socket = io(\"https://api-chat-ted2370.herokuapp.com/\"); //Change to your URL Chat-Server.\r\nlet myId;\r\n\r\nconst Chat = () => {\r\n  const [message, setMessage] = React.useState(\"\");\r\n  const [messages, setMessages] = React.useState([]);\r\n\r\n  const inputRef = React.useRef();\r\n  const messagesBox = React.useRef();\r\n\r\n  React.useEffect(() => {\r\n    myId = window.localStorage.getItem(\"myid\");\r\n    if (!myId) {\r\n      window.localStorage.setItem(\"myid\", myUuid);\r\n      myId = myUuid;\r\n    } else {\r\n      myId = window.localStorage.getItem(\"myid\");\r\n    }\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    let messagesStorage = window.localStorage.getItem(\"messages\");\r\n    if (messagesStorage) {\r\n      setMessages(JSON.parse(messagesStorage));\r\n    }\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    setTimeout(() => {\r\n      messagesBox.current.scrollTo(0, messagesBox.current.scrollHeight);\r\n    });\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    inputRef.current.focus();\r\n\r\n    socket.on(\"chat message\", (message) => {\r\n      let newMessage = [...messages, message];\r\n      setMessages(newMessage);\r\n      window.localStorage.setItem(\"messages\", JSON.stringify(newMessage));\r\n\r\n      if (message.id === myId) {\r\n        messagesBox.current.scrollTo(0, messagesBox.current.scrollHeight);\r\n      }\r\n      socket.off(\"chat message\");\r\n    });\r\n  }, [messages]);\r\n\r\n  const handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    if (message.trim()) {\r\n      socket.emit(\"chat message\", {\r\n        id: myId,\r\n        message,\r\n      });\r\n      setMessage(\"\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <section className=\"container\">\r\n      <div className=\"messages\">\r\n        <div className=\"bg\" ref={messagesBox}>\r\n          {messages.map(({ message, id, hour, minute }, index) => (\r\n            <div\r\n              key={index}\r\n              className={`message ${\r\n                id === myId ? \"message_self\" : \"message_other\"\r\n              }`}\r\n            >\r\n              <p>\r\n                {message}\r\n                <span>\r\n                  {hour}:{minute}\r\n                </span>\r\n              </p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Digite uma mensagem\"\r\n          value={message}\r\n          onChange={({ target }) => setMessage(target.value)}\r\n          ref={inputRef}\r\n        />\r\n      </form>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n","import React from \"react\";\nimport \"./App.css\";\nimport Chat from \"./Chat\";\n\nfunction App() {\n  return <Chat />;\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}